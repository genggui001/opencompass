---
jupyter:
  title: Image Reconstruction from Gaussian and Laplacian Pyramids using OpenCV
  module: opencv
  dataset: lena.png
  difficulty: Middle
  idx: 15
  num_steps: 6
  step_types:
    - exec
    - vis
    - vis
    - vis
    - vis
    - num
  modules: 
    - opencv
    - opencv & matplotlib
    - opencv & matplotlib
    - opencv & matplotlib
    - opencv & matplotlib
    - opencv & matplotlib & numpy
---

File Path: 'data/lena.png'.

Load the image from the path.
```python
import cv2
import matplotlib.pyplot as plt
input_img = cv2.imread('data/lena.png')
```

Create a Gaussian Pyramid for the input image. The pyramid is generated by iteratively reducing the size of the image. 3 iterations are performed in this case. Display the images of the Gaussian Pyramid. Each image is displayed in a separate subplot.
```python
gpyr = [input_img]
for i in range(3):
    gpyr.append(cv2.pyrDown(gpyr[i]))
for i,img in enumerate(gpyr):
    plt.subplot(2,2,i+1), plt.imshow(cv2.cvtColor(img, cv2.COLOR_BGR2RGB))
    plt.title('Gaussian Pyramid')
plt.show()
```

Generate a Laplacian Pyramid using the Gaussian Pyramid. Each level of the pyramid is obtained by subtracting an expanded version of the next level from the current level. Display the images of the Laplacian Pyramid.
```python
lpyr = [gpyr[3]]
for i in range(3,0,-1):
    ge = cv2.pyrUp(gpyr[i])
    ge = cv2.resize(ge, (gpyr[i-1].shape[1], gpyr[i-1].shape[0]))
    lpyr.append(cv2.subtract(gpyr[i-1],ge))
for i,img in enumerate(lpyr):
    plt.subplot(2,2,i+1), plt.imshow(cv2.cvtColor(img, cv2.COLOR_BGR2RGB))
    plt.title('Laplacian Pyramid')
plt.show()
```

Reconstruct the original image from the Laplacian Pyramid. This is achieved by iteratively expanding and adding the levels of the pyramid, starting from the smallest image. Display the reconstructed image
```python
reconstruct_img = lpyr[0]
for i in range(1,4):
    reconstruct_img = cv2.pyrUp(reconstruct_img)
    lpyr[i] = cv2.resize(lpyr[i], (reconstruct_img.shape[1], reconstruct_img.shape[0]))
    reconstruct_img = cv2.add(lpyr[i], reconstruct_img)
plt.imshow(cv2.cvtColor(reconstruct_img, cv2.COLOR_BGR2RGB))
plt.title('Reconstructed Image')
plt.show()
```

Compute the difference between the original and reconstructed images and display it. The difference image highlights the errors in the reconstruction.
```python
input_img = cv2.resize(input_img, (reconstruct_img.shape[1], reconstruct_img.shape[0]))
difference = cv2.subtract(input_img, reconstruct_img)
plt.imshow(cv2.cvtColor(difference, cv2.COLOR_BGR2RGB))
plt.title('Difference between original and reconstructed image')
plt.show()
```

Finally, compute the Mean Squared Error (MSE) between the original and reconstructed images. The MSE quantifies the extent of the errors in the reconstruction. Print the MSE (Keep two decimal places).
```python
import numpy as np
mse = np.mean((input_img - reconstruct_img) ** 2)
round(mse,2)
```