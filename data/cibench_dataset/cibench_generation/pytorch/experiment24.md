---
jupyter:
  title: Loading a pretrained deep learning model in PyTorch
  dataset: None
  difficulty: Easy
  module: pytorch
  idx: 24
  num_steps: 4
  step_types:
    - exec
    - exec
    - exec
    - exec
  modules:
    - pytorch
    - pytorch
    - pytorch
    - pytorch
---

Load a pretrained deep learning model. Here, we are utilizing the 'resnet18' model which is a convolutional neural network trained on millions of images from the ImageNet database. 

```python
import torch
import torchvision
model = torchvision.models.resnet18(pretrained=True)
```

Switch the model to evaluation mode. This is done because we're not going to train the model further; we're just using it for inference. Create a random tensor of size [1, 3, 224, 224]. The tensor dimensions match the expected input size of the model. This tensor will act as a dummy input for our model. Pass the input tensor through the model to get the predictions. 
```python
model.eval()
input_tensor = torch.rand(1, 3, 224, 224)
output = model(input_tensor)
print(output)
```

Convert the model into a format that can be understood by mobile and embedded devices. We do this by using JIT compilation, which stands for Just-In-Time compilation. It compiles Python code into a form that can run faster or be used by systems with less computational resources. Test the traced model by feeding the same input tensor into it and getting the output.

```python
traced_model = torch.jit.trace(model, input_tensor)
output_traced = traced_model(input_tensor)
print(output_traced)
```

Confirm that the outputs generated by the original model and the traced model are identical. This is to ensure that the conversion process has not modified the model's behavior. If the outputs are identical, it means the model's performance is preserved during the conversion process.

```python
is_output_identical = torch.allclose(output, output_traced)
print(f"Are the outputs identical? {is_output_identical}")
```

